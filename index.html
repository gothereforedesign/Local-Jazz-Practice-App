<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jazz Practice App</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('./sw.js');
        });
      }
    </script>

    <script type="text/babel">
        // PASTE EVERYTHING FROM YOUR PDF BELOW THIS LINE
        // (Starting from: import React... all the way to the end)
import React, { useState, useEffect } from 'react';
import { Shuffle, Settings, Eye, EyeOff, Maximize, Minimize, Lock, Unlock, Plus, Trash2, Save, BookmarkPlus, HelpCircle } from 'lucide-react';

const THEME_COLORS = {
  slate: { bg: 'from-slate-50 via-slate-100 to-slate-50', primary: 'bg-slate-600', hover: 'hover:bg-slate-700', name: 'Slate' },
  stone: { bg: 'from-stone-50 via-stone-100 to-stone-50', primary: 'bg-stone-600', hover: 'hover:bg-stone-700', name: 'Stone' },
  emerald: { bg: 'from-emerald-50 via-emerald-100 to-emerald-50', primary: 'bg-emerald-600', hover: 'hover:bg-emerald-700', name: 'Emerald' },
  teal: { bg: 'from-teal-50 via-teal-100 to-teal-50', primary: 'bg-teal-600', hover: 'hover:bg-teal-700', name: 'Teal' },
  sky: { bg: 'from-sky-50 via-sky-100 to-sky-50', primary: 'bg-sky-600', hover: 'hover:bg-sky-700', name: 'Sky' },
  violet: { bg: 'from-violet-50 via-violet-100 to-violet-50', primary: 'bg-violet-600', hover: 'hover:bg-violet-700', name: 'Violet' },
  rose: { bg: 'from-rose-50 via-rose-100 to-rose-50', primary: 'bg-rose-600', hover: 'hover:bg-rose-700', name: 'Rose' },
  amber: { bg: 'from-amber-50 via-amber-100 to-amber-50', primary: 'bg-amber-600', hover: 'hover:bg-amber-700', name: 'Amber' },
  olive: { bg: 'from-green-50 via-green-100 to-green-50', primary: 'bg-green-700', hover: 'hover:bg-green-800', name: 'Olive' },
  indigo: { bg: 'from-indigo-50 via-indigo-100 to-indigo-50', primary: 'bg-indigo-600', hover: 'hover:bg-indigo-700', name: 'Indigo' }
};

const TEXT_SIZES = { small: { normal: 'text-2xl', fullscreen: 'text-4xl', name: 'Small' } };

const PracticeSection = ({ sectionKey, section, isFullScreen, editMode, onToggleVisibility, onToggleLock, onEdit, onDelete, textSize, isFlashing,
  isWide, onDragStart, onDragOver, onDragEnd, isDragging, isDragOver }) => {
  return (
    <div
      draggable={editMode}
      onDragStart={(e) => editMode && onDragStart(e, sectionKey)}
      onDragOver={(e) => editMode && onDragOver(e, sectionKey)}
      onDragEnd={onDragEnd}
      className={`bg-white rounded-lg overflow-hidden border border-gray-200 shadow-sm transition-all duration-200 ${isFlashing ? 'ring-2 ring-blue-500' : ''} ${isWide ? 'col-span-2' : ''} ${editMode ? 'cursor-move' : ''} ${isDragging ? 'opacity-50' : ''} ${isDragOver ? 'ring-2 ring-blue-500' : ''}`}
    >
      <div className="flex items-center justify-between px-3 py-2 bg-gray-50 border-b border-gray-200">
        <h2 className="text-sm font-medium text-gray-700 uppercase tracking-wide">{section.name}</h2>
        <div className="flex gap-1">
          {editMode && (
            <>
              <button onClick={() => onEdit(sectionKey)} className="px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs hover:bg-gray-300 transition-all">Edit</button>
              <button onClick={() => onToggleVisibility(sectionKey)} className="p-1.5 rounded transition-all bg-gray-100 text-gray-600 hover:bg-gray-200"><EyeOff size={14} /></button>
              <button onClick={() => onDelete(sectionKey)} className="p-1.5 rounded transition-all bg-red-100 text-red-600 hover:bg-red-200"><Trash2 size={14} /></button>
            </>
          )}
          {!editMode && (
            <>
              <button onClick={() => onToggleLock(sectionKey)} className={`p-1.5 rounded transition-all ${section.locked ? 'bg-amber-100 text-amber-600' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`}>
                {section.locked ? <Lock size={14} /> : <Unlock size={14} />}
              </button>
              <button onClick={() => onToggleVisibility(sectionKey)} className="p-1.5 rounded transition-all bg-gray-100 text-gray-600 hover:bg-gray-200"><Eye size={14} /></button>
            </>
          )}
        </div>
      </div>
      <div className={`text-center flex items-center justify-center ${isFullScreen ? 'py-10' : 'py-6'} ${isFullScreen ? 'min-h-[200px]' : 'min-h-[120px]'}`}>
        <div className={`font-semibold text-gray-900 ${isFullScreen ? textSize.fullscreen : textSize.normal} break-words px-4`}>{section.current}</div>
      </div>
    </div>
  );
};

const JazzPracticeApp = () => {
  const [sections, setSections] = useState(() => {
    const saved = localStorage.getItem('jazzPracticeSections');
    return saved ? JSON.parse(saved) : {
      key: { name: 'Key', options: ['C', 'C#/Db', 'D', 'Eb', 'E', 'F', 'F#/Gb', 'G', 'G#/Ab', 'A', 'Bb', 'B'], visible: true, locked: false, current: 'C', row: 0, col: 0 },
      chord: { name: 'Chord', options: ['maj', 'min', 'dim', 'aug', 'maj7', 'maj6/9', 'm7', 'm(Maj7)', 'm7b5', 'dim7', '7', '7(b9)', '7(#11)', '7alt', '7sus'], visible: true, locked: false, current: 'maj7', row: 0, col: 1 },
      scaleDegrees: { name: 'Scale Degrees', options: ['1', 'b2', '2', 'b3', '3', '4', '#4/b5', '5', '#5/b6', '6', 'b7', '7'], visible: true, locked: false, current: '1', row: 1, col: 0 },
      progression: { name: 'Progression', options: ['ii - V - I', 'iv - ii - V - I'], visible: true, locked: false, current: 'ii - V - I', row: 1, col: 1 },
      scales: { name: 'Scales', options: ['Linear', 'Broken 3rds', 'Triads (1-3-5-3)', 'Triads 3 over 4 (1-3-5, 2-4-6...)', '7th chords', 'Approach: 3rds', 'Approach: Triads', 'Approach: 7th chords', 'Pivots'], visible: true, locked: false, current: 'Linear', row: 2, col: 0 },
      substitutions: { name: 'Substitutions', options: ['Tritone sub', 'Secondary dominant', 'Modal interchange', 'Diminished passing', 'Chromatic approach', 'Sus chords', 'Backdoor progression', 'Coltrane changes', 'Reharmonization'], visible: true, locked: false, current: 'Tritone sub', row: 2, col: 1 },
      tune: { name: 'Tune', options: ['All The Things You Are', 'Autumn Leaves', 'Blue Bossa', 'Body and Soul', 'Cherokee', 'Confirmation', 'Days of Wine and Roses', 'Giant Steps', 'Have You Met Miss Jones', 'I Got Rhythm', 'Misty', 'My Funny Valentine', 'Night and Day', 'Satin Doll', 'Stella By Starlight', 'Take the A Train', 'There Will Never Be Another You'], visible: false, locked: false, current: 'All The Things You Are', row: 3, col: 0, isWide: true },
      genre: { name: 'Genre', options: ['Jazz Standard', 'Bebop', 'Blues', 'Ballad', 'Latin', 'Swing', 'Modal', 'Hymn', 'Gospel'], visible: false, locked: false, current: 'Jazz Standard', row: 4, col: 0 }
    };
  });

  const [presets, setPresets] = useState(() => {
    const saved = localStorage.getItem('jazzPracticePresets');
    return saved ? JSON.parse(saved) : {};
  });

  const [themeColor, setThemeColor] = useState(() => {
    const saved = localStorage.getItem('jazzPracticeTheme');
    return saved || 'slate';
  });

  const [textSize] = useState('small');
  const [isFullScreen, setIsFullScreen] = useState(() => {
    const saved = localStorage.getItem('jazzPracticeFullScreen');
    return saved === 'true';
  });

  const [editMode, setEditMode] = useState(false);
  const [editingSection, setEditingSection] = useState(null);
  const [editForm, setEditForm] = useState({ name: '', options: '', isWide: false });
  const [showAddModal, setShowAddModal] = useState(false);
  const [showPresetModal, setShowPresetModal] = useState(false);
  const [showSavePresetModal, setShowSavePresetModal] = useState(false);
  const [presetName, setPresetName] = useState('');
  const [showThemeModal, setShowThemeModal] = useState(false);
  const [showHelpModal, setShowHelpModal] = useState(false);
  const [isFlashing, setIsFlashing] = useState(false);
  const [activePreset, setActivePreset] = useState(null);
  const [draggedSection, setDraggedSection] = useState(null);
  const [dragOverSection, setDragOverSection] = useState(null);
  const [deleteSectionKey, setDeleteSectionKey] = useState(null);
  const [deletePresetKey, setDeletePresetKey] = useState(null);
  const [deleteConfirmSection, setDeleteConfirmSection] = useState(null);

  useEffect(() => { localStorage.setItem('jazzPracticeSections', JSON.stringify(sections)); }, [sections]);
  useEffect(() => { localStorage.setItem('jazzPracticePresets', JSON.stringify(presets)); }, [presets]);
  useEffect(() => { localStorage.setItem('jazzPracticeTheme', themeColor); }, [themeColor]);
  useEffect(() => { localStorage.setItem('jazzPracticeFullScreen', isFullScreen); }, [isFullScreen]);

  const randomize = () => {
    setSections(prev => {
      const newSections = {};
      Object.keys(prev).forEach(key => {
        newSections[key] = { ...prev[key] };
        if (newSections[key].visible && !newSections[key].locked && newSections[key].options.length > 0) {
          const randomIndex = Math.floor(Math.random() * newSections[key].options.length);
          newSections[key].current = newSections[key].options[randomIndex];
        }
      });
      return newSections;
    });

    setIsFlashing(true);
    setTimeout(() => setIsFlashing(false), 200);
  };

  const toggleVisibility = (k) => setSections(p => ({ ...p, [k]: { ...p[k], visible: !p[k].visible } }));
  const toggleLock = (k) => setSections(p => ({ ...p, [k]: { ...p[k], locked: !p[k].locked } }));
  const toggleFullScreen = () => {
    setIsFullScreen(!isFullScreen);
  };

  const startEditing = (k) => {
    setEditingSection(k);
    setEditForm({
      name: sections[k].name,
      options: sections[k].options.join(', '),
      isWide: sections[k].isWide || false
    });
  };

  const saveEdit = () => {
    if (editingSection) {
      const newOpts = editForm.options.split(',').map(o => o.trim()).filter(o => o.length > 0);
      setSections(p => ({
        ...p,
        [editingSection]: {
          ...p[editingSection],
          name: editForm.name.trim() || p[editingSection].name,
          options: newOpts.length > 0 ? newOpts : p[editingSection].options,
          current: newOpts.length > 0 ? newOpts[0] : p[editingSection].current,
          isWide: editForm.isWide
        }
      }));
      setEditingSection(null);
      setEditForm({ name: '', options: '', isWide: false });
    }
  };

  const cancelEdit = () => { setEditingSection(null); setEditForm({ name: '', options: '', isWide: false }); };

  const deleteSection = (k) => {
    setDeleteConfirmSection(k);
  };

  const confirmDelete = () => {
    if (deleteConfirmSection) {
      setSections(p => {
        const n = { ...p };
        delete n[deleteConfirmSection];
        return n;
      });
      setDeleteConfirmSection(null);
    }
  };

  const cancelDelete = () => {
    setDeleteConfirmSection(null);
  };

  const addNewSection = () => {
    if (!editForm.name.trim() || !editForm.options.trim()) { alert('Provide name and options.'); return; }
    const newOpts = editForm.options.split(',').map(o => o.trim()).filter(o => o.length > 0);
    if (newOpts.length === 0) { alert('Provide at least one option.'); return; }
    const newKey = `section_${Date.now()}`;
    const allSecs = Object.values(sections);
    const maxRow = Math.max(0, ...allSecs.map(s => s.row));
    const secsInLastRow = allSecs.filter(s => s.row === maxRow).length;
    const newRow = secsInLastRow >= 2 ? maxRow + 1 : maxRow;
    const newCol = secsInLastRow >= 2 ? 0 : secsInLastRow;

    setSections(p => ({
      ...p,
      [newKey]: {
        name: editForm.name.trim(),
        options: newOpts,
        visible: true,
        locked: false,
        current: newOpts[0],
        row: newRow,
        col: newCol,
        isWide: editForm.isWide || false
      }
    }));
    setShowAddModal(false);
    setEditForm({ name: '', options: '', isWide: false });
  };

  const savePreset = () => {
    if (!presetName.trim()) { alert('Enter preset name.'); return; }
    const cfg = {};
    Object.entries(sections).forEach(([k, s]) => { cfg[k] = { visible: s.visible, locked: s.locked }; });
    setPresets(p => ({ ...p, [presetName]: { config: cfg, theme: themeColor } }));
    setShowSavePresetModal(false);
    setPresetName('');
  };

  const loadPreset = (k) => {
    const preset = presets[k];
    if (!preset) return;
    setSections(p => {
      const n = { ...p };
      Object.entries(preset.config).forEach(([key, cfg]) => {
        if (n[key]) n[key] = { ...n[key], visible: cfg.visible, locked: cfg.locked };
      });
      return n;
    });
    if (preset.theme) setThemeColor(preset.theme);
    setActivePreset(k);
    setShowPresetModal(false);
  };

  const deletePreset = (k) => {
    setDeletePresetKey(k);
  };

  const confirmDeletePreset = () => {
    if (deletePresetKey) {
      setPresets(p => { const n = { ...p }; delete n[deletePresetKey]; return n; });
      if (activePreset === deletePresetKey) setActivePreset(null);
      setDeletePresetKey(null);
    }
  };

  const cancelDeletePreset = () => {
    setDeletePresetKey(null);
  };

  const handleDragStart = (e, sectionKey) => {
    setDraggedSection(sectionKey);
    e.dataTransfer.effectAllowed = 'move';
  };

  const handleDragOver = (e, sectionKey) => {
    e.preventDefault();
    if (draggedSection !== sectionKey) {
      setDragOverSection(sectionKey);
    }
  };

  const handleDragEnd = () => {
    if (draggedSection && dragOverSection && draggedSection !== dragOverSection) {
      setSections(prev => {
        const newSections = { ...prev };
        const draggedRow = newSections[draggedSection].row;
        const draggedCol = newSections[draggedSection].col;
        const targetRow = newSections[dragOverSection].row;
        const targetCol = newSections[dragOverSection].col;
        newSections[draggedSection].row = targetRow;
        newSections[draggedSection].col = targetCol;
        newSections[dragOverSection].row = draggedRow;
        newSections[dragOverSection].col = draggedCol;
        return newSections;
      });
    }
    setDraggedSection(null);
    setDragOverSection(null);
  };

  const theme = THEME_COLORS[themeColor] || THEME_COLORS.slate;
  const currentTextSize = TEXT_SIZES.small;

  return (
    <div className={`min-h-screen bg-gradient-to-br ${theme.bg} p-4`}>
      <div className="max-w-5xl mx-auto">
        {!isFullScreen && (
          <>
            <div className="text-center mb-6 pt-4">
              <h1 className="text-3xl font-bold text-gray-900 mb-1">Jazz Practice</h1>
              <p className="text-gray-600 text-sm">Randomized Practice Tool</p>
            </div>

            {Object.keys(presets).length > 0 && (
              <div className="mb-4 overflow-x-auto">
                <div className="flex gap-2 pb-2">
                  {Object.keys(presets).map((k, index) => (
                    <button
                      key={k}
                      onClick={() => loadPreset(k)}
                      className={`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-all flex-shrink-0 shadow-sm ${
                        activePreset === k
                          ? `${theme.primary} text-white`
                          : 'bg-white text-gray-700 hover:bg-gray-100 border border-gray-200'
                      } ${index > 2 ? 'opacity-40' : 'opacity-100'}`}
                    >
                      {k}
                    </button>
                  ))}
                </div>
              </div>
            )}

            <div className="bg-white rounded-lg shadow-sm p-3 mb-4 flex justify-between items-center border border-gray-200">
              <div className="flex gap-2">
                <button onClick={() => setEditMode(!editMode)} className={`flex items-center gap-2 px-3 py-1.5 rounded text-sm transition-all ${editMode ? `${theme.primary} text-white` : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}>
                  <Settings size={16} /> {editMode ? 'Done' : 'Edit'}
                </button>
                {editMode && <button onClick={() => { setEditForm({ name: '', options: '', isWide: false }); setShowAddModal(true); }} className={`flex items-center gap-2 px-3 py-1.5 rounded text-sm ${theme.primary} text-white ${theme.hover} transition-all`}><Plus size={16} /> Add</button>}
                {!editMode && <button onClick={() => setShowPresetModal(true)} className="flex items-center gap-2 px-3 py-1.5 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition-all"><BookmarkPlus size={16} /> Presets</button>}
                {!editMode && <button onClick={() => setShowHelpModal(true)} className="flex items-center gap-2 px-3 py-1.5 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition-all"><HelpCircle size={16} /> Help</button>}
              </div>

              <button onClick={toggleFullScreen} className="flex items-center gap-2 px-3 py-1.5 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition-all"><Maximize size={16} /> Full</button>
            </div>
          </>
        )}

        {isFullScreen && (
          <div className="flex justify-between items-center mb-4 bg-white rounded-lg shadow-sm p-3 border border-gray-200">
            <p className="text-gray-600 text-sm">Full screen mode</p>
            <button onClick={toggleFullScreen} className="flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm bg-gray-100 text-gray-700 hover:bg-gray-200 transition-all shadow-sm"><Minimize size={16} /> Exit</button>
          </div>
        )}

        <div className="space-y-4 mb-4">
          <div className="grid grid-cols-2 gap-4">
            {Object.entries(sections)
              .filter(([_, s]) => s.visible)
              .sort((a, b) => {
                if (a[1].row !== b[1].row) return a[1].row - b[1].row;
                return a[1].col - b[1].col;
              })
              .map(([key, section]) => (
                <PracticeSection
                  key={key}
                  sectionKey={key}
                  section={section}
                  isFullScreen={isFullScreen}
                  editMode={editMode}
                  onToggleVisibility={toggleVisibility}
                  onToggleLock={toggleLock}
                  onEdit={startEditing}
                  onDelete={deleteSection}
                  textSize={currentTextSize}
                  isFlashing={isFlashing}
                  isWide={section.isWide}
                  onDragStart={handleDragStart}
                  onDragOver={handleDragOver}
                  onDragEnd={handleDragEnd}
                  isDragging={draggedSection === key}
                  isDragOver={dragOverSection === key}
                />
              ))}
          </div>

          {editMode && !isFullScreen && (
            <div className="grid grid-cols-2 gap-4">
              {Object.entries(sections).map(([k, s]) => !s.visible ? (
                <div key={k} className="bg-gray-50 rounded-lg overflow-hidden border-2 border-dashed border-gray-300">
                  <div className="flex items-center justify-between p-3">
                    <h2 className="text-sm font-medium text-gray-500 uppercase tracking-wide">{s.name} (Hidden)</h2>
                    <button onClick={() => toggleVisibility(k)} className="p-1.5 rounded transition-all bg-gray-200 text-gray-500 hover:bg-gray-300"><EyeOff size={14} /></button>
                  </div>
                </div>
              ) : null)}
            </div>
          )}
        </div>

        <button onClick={randomize} className={`w-full ${theme.primary} text-white rounded-lg font-semibold flex items-center justify-center gap-3 ${theme.hover} transition-all shadow-md ${isFullScreen ? 'py-6 text-xl' : 'py-4 text-lg'}`}>
          <Shuffle size={isFullScreen ? 28 : 24} /> Randomize
        </button>
      </div>

      {editingSection && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-6 max-w-md w-full border border-gray-200 shadow-xl">
            <h3 className="text-xl font-semibold text-gray-900 mb-4">Edit Section</h3>
            <div className="space-y-4">
              <div>
                <label className="text-gray-700 text-sm mb-2 block font-medium">Section Name</label>
                <input type="text" value={editForm.name} onChange={(e) => setEditForm({ ...editForm, name: e.target.value })} className="w-full bg-gray-50 text-gray-900 p-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200" />
              </div>
              <div>
                <label className="text-gray-700 text-sm mb-2 block font-medium">Options (comma-separated)</label>
                <textarea value={editForm.options} onChange={(e) => setEditForm({ ...editForm, options: e.target.value })} className="w-full bg-gray-50 text-gray-900 p-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 min-h-32" />
              </div>
              <div className="flex items-center gap-2">
                <input type="checkbox" id="isWide" checked={editForm.isWide} onChange={(e) => setEditForm({ ...editForm, isWide: e.target.checked })} className="w-4 h-4 rounded border-gray-300" />
                <label htmlFor="isWide" className="text-gray-700 text-sm">Full Width Section (spans both columns)</label>
              </div>
            </div>
            <div className="flex gap-3 mt-6">
              <button onClick={saveEdit} className={`flex-1 ${theme.primary} text-white py-2.5 rounded-lg ${theme.hover} transition-all font-semibold shadow-md`}>Save</button>
              <button onClick={cancelEdit} className="flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-lg hover:bg-gray-200 transition-all font-semibold">Cancel</button>
            </div>
          </div>
        </div>
      )}

      {showAddModal && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-6 max-w-md w-full border border-gray-200 shadow-xl">
            <h3 className="text-xl font-semibold text-gray-900 mb-4">Add New Section</h3>
            <div className="space-y-4">
              <div>
                <label className="text-gray-700 text-sm mb-2 block font-medium">Section Name</label>
                <input type="text" value={editForm.name} onChange={(e) => setEditForm({ ...editForm, name: e.target.value })} className="w-full bg-gray-50 text-gray-900 p-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200" />
              </div>
              <div>
                <label className="text-gray-700 text-sm mb-2 block font-medium">Options (comma-separated)</label>
                <textarea value={editForm.options} onChange={(e) => setEditForm({ ...editForm, options: e.target.value })} className="w-full bg-gray-50 text-gray-900 p-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 min-h-32" />
              </div>
              <div className="flex items-center gap-2">
                <input type="checkbox" id="isWideAdd" checked={editForm.isWide} onChange={(e) => setEditForm({ ...editForm, isWide: e.target.checked })} className="w-4 h-4 rounded border-gray-300" />
                <label htmlFor="isWideAdd" className="text-gray-700 text-sm">Full Width Section (spans both columns)</label>
              </div>
            </div>
            <div className="flex gap-3 mt-6">
              <button onClick={addNewSection} className={`flex-1 ${theme.primary} text-white py-2.5 rounded-lg ${theme.hover} transition-all font-semibold shadow-md`}>Add</button>
              <button onClick={() => { setShowAddModal(false); setEditForm({ name: '', options: '', isWide: false }); }} className="flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-lg hover:bg-gray-200 transition-all font-semibold">Cancel</button>
            </div>
          </div>
        </div>
      )}

      {showPresetModal && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-6 max-w-md w-full border border-gray-200 shadow-xl">
            <h3 className="text-xl font-semibold text-gray-900 mb-4">Presets</h3>
            <div className="mb-4 space-y-2">
              <button onClick={() => { setShowPresetModal(false); setShowSavePresetModal(true); }} className={`w-full flex items-center justify-center gap-2 ${theme.primary} text-white py-2.5 rounded-lg ${theme.hover} transition-all font-semibold shadow-md`}><Save size={16} /> Save Current Setup</button>
              <button onClick={() => { setShowPresetModal(false); setShowThemeModal(true); }} className="w-full flex items-center justify-center gap-2 bg-gray-100 text-gray-700 py-2.5 rounded-lg hover:bg-gray-200 transition-all font-semibold">ðŸŽ¨ Theme Color</button>
            </div>
            <div className="space-y-2 max-h-64 overflow-y-auto">
              {Object.keys(presets).length === 0 ? (
                <p className="text-gray-500 text-sm text-center py-4">No presets saved</p>
              ) : (
                Object.keys(presets).map(k => (
                  <div key={k} className="flex items-center justify-between bg-gray-50 p-3 rounded-lg border border-gray-200">
                    <button onClick={() => loadPreset(k)} className="flex-1 text-left text-gray-900 hover:text-blue-600 transition-colors font-medium">{k}</button>
                    <button onClick={(e) => { e.stopPropagation(); deletePreset(k); }} className="p-1.5 rounded transition-all bg-red-100 text-red-600 hover:bg-red-200 ml-2"><Trash2 size={14} /></button>
                  </div>
                ))
              )}
            </div>
            <button onClick={() => setShowPresetModal(false)} className="w-full bg-gray-100 text-gray-700 py-2.5 rounded-lg hover:bg-gray-200 transition-all font-semibold mt-4">Close</button>
          </div>
        </div>
      )}

      {showSavePresetModal && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-6 max-w-md w-full border border-gray-200 shadow-xl">
            <h3 className="text-xl font-semibold text-gray-900 mb-4">Save Preset</h3>
            <p className="text-gray-600 text-sm mb-4">Saves which sections are visible and locked</p>
            <div>
              <label className="text-gray-700 text-sm mb-2 block font-medium">Preset Name</label>
              <input type="text" value={presetName} onChange={(e) => setPresetName(e.target.value)} className="w-full bg-gray-50 text-gray-900 p-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200" />
            </div>
            <div className="flex gap-3 mt-6">
              <button onClick={savePreset} className={`flex-1 ${theme.primary} text-white py-2.5 rounded-lg ${theme.hover} transition-all font-semibold shadow-md`}>Save</button>
              <button onClick={() => { setShowSavePresetModal(false); setPresetName(''); setShowPresetModal(true); }} className="flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-lg hover:bg-gray-200 transition-all font-semibold">Cancel</button>
            </div>
          </div>
        </div>
      )}

      {showThemeModal && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-6 max-w-md w-full border border-gray-200 shadow-xl">
            <h3 className="text-xl font-semibold text-gray-900 mb-4">Choose Theme Color</h3>
            <div className="grid grid-cols-2 gap-3 mb-4">
              {Object.entries(THEME_COLORS).map(([key, color]) => (
                <button key={key} onClick={() => setThemeColor(key)} className={`${color.primary} ${color.hover} text-white py-3 px-4 rounded-lg transition-all font-semibold shadow-md ${themeColor === key ? 'ring-2 ring-offset-2 ring-gray-900' : ''}`}>
                  {color.name}
                </button>
              ))}
            </div>
            <button onClick={() => { setShowThemeModal(false); setShowPresetModal(true); }} className="w-full bg-gray-100 text-gray-700 py-2.5 rounded-lg hover:bg-gray-200 transition-all font-semibold">Done</button>
          </div>
        </div>
      )}

      {showHelpModal && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-6 max-w-lg w-full border border-gray-200 shadow-xl">
            <h3 className="text-xl font-semibold text-gray-900 mb-4">Gestures & Features</h3>
            <div className="space-y-4 text-gray-700 max-h-96 overflow-y-auto">
              <div>
                <h4 className="font-semibold text-gray-900 mb-2">ðŸ“± Touch Gestures</h4>
                <ul className="space-y-1 text-sm">
                  <li><strong>Drag & Drop</strong> - In edit mode, drag sections to reorder</li>
                </ul>
              </div>
              <div>
                <h4 className="font-semibold text-gray-900 mb-2">âœ¨ Features</h4>
                <ul className="space-y-1 text-sm">
                  <li><strong>Visual Flash</strong> - Blue ring flashes when randomizing</li>
                  <li><strong>Lock Sections</strong> - Click lock icon to keep a value fixed</li>
                  <li><strong>Quick Preset Tabs</strong> - One-tap preset switching at the top</li>
                  <li><strong>Persistent Full Screen</strong> - App remembers your preference</li>
                  <li><strong>Theme Colors</strong> - 10 beautiful muted tones</li>
                  <li><strong>Preset Fade Effect</strong> - Presets fade as they scroll off screen</li>
                  <li><strong>Full-Width Sections</strong> - Tune names span entire width</li>
                  <li><strong>Drag to Reorder</strong> - In edit mode, drag sections to change position</li>
                </ul>
              </div>
              <div>
                <h4 className="font-semibold text-gray-900 mb-2">ðŸ’¡ Tips</h4>
                <ul className="space-y-1 text-sm">
                  <li>Create presets for different practice routines</li>
                  <li>Lock sections to focus on specific elements</li>
                  <li>Hide sections you don't need for cleaner view</li>
                  <li>Use full screen mode when practicing away from device</li>
                  <li>Swipe horizontally to see hidden preset tabs</li>
                </ul>
              </div>
            </div>
            <button onClick={() => setShowHelpModal(false)} className="w-full bg-gray-100 text-gray-700 py-2.5 rounded-lg hover:bg-gray-200 transition-all font-semibold mt-4">Close</button>
          </div>
        </div>
      )}

      {deleteConfirmSection && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-6 max-w-sm w-full border border-gray-200 shadow-xl">
            <h3 className="text-xl font-semibold text-gray-900 mb-2">Delete Section?</h3>
            <p className="text-gray-600 text-sm mb-6">
              Are you sure you want to delete "<strong>{sections[deleteConfirmSection].name}</strong>"? This action cannot be undone.
            </p>
            <div className="flex gap-3">
              <button onClick={confirmDelete} className="flex-1 bg-red-600 text-white py-2.5 rounded-lg hover:bg-red-700 transition-all font-semibold shadow-md">Delete</button>
              <button onClick={cancelDelete} className="flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-lg hover:bg-gray-200 transition-all font-semibold">Cancel</button>
            </div>
          </div>
        </div>
      )}

      {deletePresetKey && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-6 max-w-sm w-full border border-gray-200 shadow-xl">
            <h3 className="text-xl font-semibold text-gray-900 mb-2">Delete Preset?</h3>
            <p className="text-gray-600 text-sm mb-6">
              Are you sure you want to delete the preset "<strong>{deletePresetKey}</strong>"? This action cannot be undone.
            </p>
            <div className="flex gap-3">
              <button onClick={confirmDeletePreset} className="flex-1 bg-red-600 text-white py-2.5 rounded-lg hover:bg-red-700 transition-all font-semibold shadow-md">Delete</button>
              <button onClick={cancelDeletePreset} className="flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-lg hover:bg-gray-200 transition-all font-semibold">Cancel</button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default JazzPracticeApp;

        // At the very bottom of your pasted code, add this line:
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<JazzPracticeApp />);
    </script>
</body>
</html>